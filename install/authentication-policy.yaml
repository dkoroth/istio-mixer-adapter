# Creates an Authentication policy and binds it to service.
# The example forces requests to the "helloworld" service to have a valid JWT.
# Configure issuer, jwks_uri, and services as appropriate.
---
# Define an Istio Auth Policy
apiVersion: "authentication.istio.io/v1alpha1"
kind: Policy
metadata:
  name: auth-spec
spec:
  targets:
  - name: helloworld
  peers:
  - mtls:
  origins:
  - jwt:
      issuer: https://theganyo1-eval-test.apigee.net/edgemicro-auth/verifyApiKey
      jwks_uri: https://theganyo1-eval-test.apigee.net/edgemicro-auth/jwkPublicKeys
  - jwt:
      issuer: https://theganyo1-eval-test.apigee.net/edgemicro-auth/token
      jwks_uri: https://theganyo1-eval-test.apigee.net/edgemicro-auth/jwkPublicKeys
  principalBinding: USE_ORIGIN
